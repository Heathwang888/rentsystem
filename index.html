<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ‰‹æ©Ÿç§Ÿè³ƒå¾Œå°ç³»çµ±</title>
  <style>
    body { margin: 0; font-family: 'Noto Sans TC', sans-serif; background: #f4f4f4; }
    .sidebar { width: 200px; height: 100vh; background: #333; color: #fff; position: fixed; top: 0; left: 0; display: flex; flex-direction: column; }
    .sidebar button { background: none; border: none; color: #fff; padding: 20px; text-align: left; cursor: pointer; font-size: 16px; }
    .sidebar button:hover { background: #444; }
    .page-content { margin-left: 200px; padding: 20px; }
    .page { display: none; }
    .page.active { display: block; }
    form { background: white; padding: 20px; border-radius: 8px; margin-top: 20px; }
    form label { display: block; margin: 10px 0; }
    input, select { margin-left: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
    button { padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background: #45a049; }
    .filter-bar { margin-bottom: 20px; }
    .filter-bar button { background: #f8f9fa; color: #333; margin-right: 10px; }
    .filter-bar button.active { background: #f3cc00; }
    .customer-card { border: 1px solid #ccc; border-radius: 8px; padding: 12px; margin-bottom: 10px; background: #fff; }
    .card-header { display: flex; flex-direction: column; gap: 6px; }
    .card-top { display: flex; justify-content: space-between; align-items: center; }
    .right-section span { margin-left: 10px; }
    .card-summary { display: flex; gap: 12px; align-items: center; justify-content: space-between; }
    .card-actions button { margin-right: 10px; }
    .note-input { width: 200px; }
    .modal { position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); }
    .modal-content { background-color: #fff; margin: 10% auto; padding: 20px; width: 300px; border-radius: 8px; }
    .close-modal { float: right; cursor: pointer; }
  </style>
</head>
<body>
  <div class="sidebar">
    <button onclick="showPage('dashboard')">ğŸ“Š ç¸½è¦½</button>
    <button onclick="showPage('list')">ğŸ“ å®¢æˆ¶åˆ—è¡¨</button>
    <button onclick="showPage('add')">â• æ–°å¢å®¢æˆ¶</button>
    <button onclick="showPage('edit')">âœï¸ ç·¨è¼¯å®¢æˆ¶</button>
    <button onclick="showPage('contract')">ğŸ“„ åˆç´„ç”¢è£½</button>
  </div>

  <div class="page-content">
    <div id="dashboard" class="page active">
      <h2>ç¸½è¦½</h2>
      <div class="dashboard-stats">
        <div class="stat-card">
          <h3>ç¸½å®¢æˆ¶æ•¸</h3>
          <p class="stat-number">0</p>
        </div>
        <div class="stat-card">
          <h3>ç§Ÿè³ƒä¸­</h3>
          <p class="stat-number">0</p>
        </div>
        <div class="stat-card">
          <h3>å·²è²·å›</h3>
          <p class="stat-number">0</p>
        </div>
        <div class="stat-card">
          <h3>å‘†å¸³</h3>
          <p class="stat-number">0</p>
        </div>
      </div>
    </div>

    <div id="list" class="page">
      <h2>å®¢æˆ¶åˆ—è¡¨</h2>
      <div class="filter-bar">
        <button class="active">å…¨éƒ¨</button>
        <button>ä»Šæ—¥é ˆç¹³æ¬¾</button>
        <button>å·²è²·å›</button>
        <button>å‘†å¸³é–æ©Ÿ</button>
      </div>
      <div class="search-box">
        <input type="text" placeholder="æœå°‹å®¢æˆ¶...">
      </div>
      <div class="customer-cards">
        <!-- å®¢æˆ¶å¡ç‰‡å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
      </div>
      <div class="pagination">
        <!-- åˆ†é æŒ‰éˆ•å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
      </div>
    </div>

    <div id="add" class="page">
      <h2>æ–°å¢å®¢æˆ¶</h2>
      <div class="customer-form">
        <div class="form-header">
          <h3>æ–°å¢å®¢æˆ¶</h3>
        </div>

        <form id="uploadForm" class="form-section active">
          <div class="form-grid">
            <!-- åŸºæœ¬è³‡æ–™ -->
            <div class="form-group">
              <label>å§“å</label>
              <input type="text" name="name" placeholder="è«‹è¼¸å…¥å§“å" required>
            </div>
            <div class="form-group">
              <label>èº«åˆ†è­‰å­—è™Ÿ</label>
              <input type="text" name="idNumber" placeholder="è«‹è¼¸å…¥èº«åˆ†è­‰å­—è™Ÿ" required>
            </div>
            <div class="form-group">
              <label>æ‰‹æ©Ÿè™Ÿç¢¼</label>
              <input type="tel" name="phone" placeholder="è«‹è¼¸å…¥æ‰‹æ©Ÿè™Ÿç¢¼" required>
            </div>
            <div class="form-group">
              <label>æˆ¶ç±åœ°å€</label>
              <input type="text" name="address" placeholder="è«‹è¼¸å…¥æˆ¶ç±åœ°å€" required>
            </div>
            <div class="form-group">
              <label>é€šè¨Šåœ°å€</label>
              <div class="address-options">
                <input type="text" name="mailingAddress" placeholder="è«‹è¼¸å…¥é€šè¨Šåœ°å€">
                <label class="checkbox-label">
                  <input type="checkbox" name="sameAsResidence" onchange="toggleMailingAddress(this)">
                  åŒæˆ¶ç±åœ°å€
                </label>
              </div>
            </div>

            <!-- æ‰‹æ©Ÿè³‡è¨Š -->
            <div class="form-group">
              <label>æ‰‹æ©Ÿå‹è™Ÿ</label>
              <select name="phoneModel" required>
                <option value="">è«‹é¸æ“‡å‹è™Ÿ</option>
                <option>iPhone 12</option>
                <option>iPhone 12 mini</option>
                <option>iPhone 12 Pro</option>
                <option>iPhone 12 Pro Max</option>
                <option>iPhone 13</option>
                <option>iPhone 13 mini</option>
                <option>iPhone 13 Pro</option>
                <option>iPhone 13 Pro Max</option>
                <option>iPhone 14</option>
                <option>iPhone 14 Plus</option>
                <option>iPhone 14 Pro</option>
                <option>iPhone 14 Pro Max</option>
                <option>iPhone 15</option>
                <option>iPhone 15 Plus</option>
                <option>iPhone 15 Pro</option>
                <option>iPhone 15 Pro Max</option>
                <option>iPhone 16</option>
                <option>iPhone 16 e</option>
                <option>iPhone 16 Plus</option>
                <option>iPhone 16 Pro</option>
                <option>iPhone 16 Pro Max</option>
              </select>
            </div>
            <div class="form-group">
              <label>IMEI</label>
              <input type="text" name="imei" placeholder="è«‹è¼¸å…¥IMEIç¢¼" required>
            </div>
            <div class="form-group">
              <label>è¢å¹•å¯†ç¢¼</label>
              <input type="text" name="screenPassword" placeholder="è«‹è¼¸å…¥è¢å¹•å¯†ç¢¼">
            </div>

            <!-- åˆç´„è³‡è¨Š -->
            <div class="form-group">
              <label>è²·è³£åƒ¹é‡‘</label>
              <input type="number" name="price" placeholder="è«‹è¼¸å…¥è²·è³£åƒ¹é‡‘" required>
            </div>
            <div class="form-group">
              <label>ç§Ÿé‡‘</label>
              <input type="number" name="rent" placeholder="è«‹è¼¸å…¥ç§Ÿé‡‘" required>
            </div>
            <div class="form-group">
              <label>åˆç´„æ—¥æœŸ</label>
              <input type="date" name="contractDate" required>
            </div>

            <!-- æ–‡ä»¶ä¸Šå‚³ -->
            <div class="form-group">
              <label>ä¸Šå‚³å¥‘ç´„æ›¸</label>
              <input type="file" name="contractFile" accept=".pdf,.jpg,.jpeg,.png" required>
            </div>
            <div class="form-group">
              <label>ä¸Šå‚³èº«åˆ†è­‰æ­£é¢</label>
              <input type="file" name="idFront" accept=".jpg,.jpeg,.png" required>
            </div>
            <div class="form-group">
              <label>ä¸Šå‚³èº«åˆ†è­‰åé¢</label>
              <input type="file" name="idBack" accept=".jpg,.jpeg,.png" required>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="button button-primary">å„²å­˜</button>
            <button type="button" class="button button-danger" onclick="this.form.reset()">å–æ¶ˆ</button>
          </div>
        </form>
      </div>
    </div>

    <div id="edit" class="page">
      <h2>ç·¨è¼¯å®¢æˆ¶</h2>
      <!-- ç·¨è¼¯å®¢æˆ¶çš„å…§å®¹å°‡åœ¨æ­¤è™•æ·»åŠ  -->
    </div>

    <div id="contract" class="page">
      <h2>åˆç´„ç”¢è£½</h2>
      <div class="contract-form">
        <form id="generate-contract-form">
          <label>å®¢æˆ¶å§“åï¼š<input type="text" name="customerName" required></label>
          <label>èº«åˆ†è­‰å­—è™Ÿï¼š<input type="text" name="idNumber" required></label>
          <label>æ‰‹æ©Ÿå‹è™Ÿï¼š<input type="text" name="phoneModel" required></label>
          <label>è²·è³£åƒ¹é‡‘ï¼š<input type="number" name="price" required></label>
          <label>é€±ç§Ÿé‡‘ï¼š<input type="number" name="weeklyRent" required></label>
          <label>åˆç´„èµ·å§‹æ—¥ï¼š<input type="date" name="startDate" required></label>
          <button type="submit">ç”¢ç”Ÿåˆç´„</button>
        </form>
      </div>
      <div class="contract-preview" style="display:none;">
        <h3>åˆç´„é è¦½</h3>
        <iframe id="contract-preview-frame"></iframe>
        <button id="download-contract">ä¸‹è¼‰åˆç´„</button>
      </div>
    </div>
  </div>

  <script>
    // åˆå§‹åŒ–é é¢
    document.addEventListener('DOMContentLoaded', function() {
      showPage('dashboard');
    });

    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(pageId).classList.add('active');
    }

    // ... existing code ...

    // åˆç´„ç”¢è£½åŠŸèƒ½
    document.getElementById('generate-contract-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      fetch('/api/contracts/generate', {
        method: 'POST',
        body: formData
      })
      .then(response => response.blob())
      .then(blob => {
        const previewFrame = document.getElementById('contract-preview-frame');
        const previewDiv = document.querySelector('.contract-preview');
        previewDiv.style.display = 'block';
        previewFrame.src = URL.createObjectURL(blob);
      })
      .catch(error => alert('åˆç´„ç”¢ç”Ÿå¤±æ•—'));
    });

    document.getElementById('download-contract').addEventListener('click', function() {
      const previewFrame = document.getElementById('contract-preview-frame');
      const link = document.createElement('a');
      link.href = previewFrame.src;
      link.download = 'åˆç´„.pdf';
      link.click();
    });
  </script>
</body>
</html>
